<div class="registro-container">
  <h2>{{ editMode ? 'Editar datos personales' : 'Registro de usuario' }}</h2>

  <div *ngIf="serverError" class="server-error">
    {{ serverError }}
  </div>

  <form [formGroup]="registerForm" (ngSubmit)="submit()">

    <div class="form-section">
      <h3>Datos Personales</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="nombre">Nombre</label>
          <input id="nombre" formControlName="nombre" placeholder="Ingrese su nombre">
          <div *ngIf="registerForm.get('nombre')?.invalid && registerForm.get('nombre')?.touched" class="error">
            <span *ngIf="registerForm.get('nombre')?.errors?.['required']">El nombre es obligatorio</span>
          </div>
        </div>

        <div class="form-group">
          <label for="apellido">Apellido</label>
          <input id="apellido" formControlName="apellido" placeholder="Ingrese su apellido">
          <div *ngIf="registerForm.get('apellido')?.invalid && registerForm.get('apellido')?.touched" class="error">
            <span *ngIf="registerForm.get('apellido')?.errors?.['required']">El apellido es obligatorio</span>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="email">Correo Electrónico</label>
          <input id="email" formControlName="email" placeholder="correo@ejemplo.com" type="email">
          <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="error">
            <span *ngIf="registerForm.get('email')?.errors?.['required']">El email es obligatorio</span>
            <span *ngIf="registerForm.get('email')?.errors?.['email']">Formato de email inválido</span>
          </div>
        </div>

        <div class="form-group">
          <label for="telefono">Teléfono</label>
          <input id="telefono" formControlName="telefono" placeholder="Ingrese su teléfono">
        </div>
      </div>

      <div class="form-group" *ngIf="!editMode">
        <label for="password">Contraseña</label>
        <input id="password" type="password" formControlName="password" placeholder="Ingrese su contraseña">
      </div>
    </div>

    <div class="form-section">
      <h3>Ubicación</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="ciudad">Ciudad</label>
          <select id="ciudad" formControlName="ciudad" (change)="onCiudadChange(+$any($event.target).value)">
            <option value="">Seleccione una ciudad</option>
            <option *ngFor="let ciudad of ciudades" [value]="ciudad.id">{{ ciudad.nombre }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="barrio">Barrio</label>
          <select id="barrio" formControlName="barrio">
            <option value="">Seleccione un barrio</option>
            <option *ngFor="let barrio of barrios" [value]="barrio.id">{{ barrio.nombre }}</option>
          </select>
        </div>
      </div>
    </div>

    <button type="submit" [disabled]="registerForm.invalid">
      {{ editMode ? 'Guardar cambios' : 'Registrarse' }}
    </button>

  </form>

  <p *ngIf="!editMode" class="login-link">
    ¿Ya tenés cuenta?
    <a routerLink="/login">Iniciar sesión</a>
  </p>
</div>

